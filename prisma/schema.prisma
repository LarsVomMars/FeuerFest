datasource db {
    provider = "mysql"
    url      = env("DATABASE_URL")
}

// TODO: Non-Nullable and insert empty string as default
model User {
    id        Int       @id @default(autoincrement())
    email     String    @unique
    name      String
    username  String    @unique
    password  String    @default("")
    role      Role      @default(USER)
    status    Status    @default(PENDING)
    createdAt DateTime  @default(now())
    updatedAt DateTime? @updatedAt

    dummy Boolean @default(false) // Pending user without an account

    UserSession UserSession[]
    Event       Event[]
    EventStaff  EventStaff[]
}

// token insted of id?
model UserSession {
    id        Int      @id @default(autoincrement())
    user      User     @relation(fields: [userId], references: [id])
    token     String   @unique
    createdAt DateTime @default(now())
    expiresAt DateTime

    userId Int
}

model Event {
    id          Int      @id @default(autoincrement())
    name        String
    slug        String   @unique
    description String
    location    String
    start       DateTime
    end         DateTime

    createdAt   DateTime  @default(now())
    createdBy   User      @relation(fields: [createdById], references: [id])
    updatedAt   DateTime? @updatedAt
    createdById Int

    EventStaff EventStaff[]
}

model EventStaff {
    id        Int       @id @default(autoincrement())
    event     Event     @relation(fields: [eventId], references: [id])
    user      User      @relation(fields: [userId], references: [id])
    role      Role      @default(USER)
    createdAt DateTime  @default(now())
    updatedAt DateTime? @updatedAt

    eventId Int
    userId  Int
}

enum Role {
    USER
    ADMIN
    OWNER
}

enum Status {
    PENDING
    ACTIVE
    INACTIVE
}
